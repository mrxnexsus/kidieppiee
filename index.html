<?php

function displayIdolMessages($jsonFile) {
    $jsonData = file_get_contents($jsonFile);
    $data = json_decode($jsonData, true);

    if ($data['success'] && $data['code'] === 200) {
        foreach ($data['data'] as $entry) {
            $idolName = $entry['idol_name'];
            $message = $entry['message'];
            echo "<h2>Idol Name: $idolName</h2>";
            echo "<p>Message: $message</p>";

            if (!empty($entry['attachments'])) {
                foreach ($entry['attachments'] as $attachment) {
                    $filePath = $attachment['file_path'];
                    echo "<p>File Path: <a href='@https://production.jkt48pm.my.id/$filePath'>@https://production.jkt48pm.my.id/$filePath</a></p>";
                }
            }
            echo "<hr>";
        }
    } else {
        echo "<p>Failed to retrieve data from $jsonFile</p>";
    }
}

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idol Messages</title>
</head>
<body>
    <h1>Idol Messages</h1>
    <?php
    displayIdolMessages('jessi.json');
    displayIdolMessages('fiony.json');
    displayIdolMessages('indira.json');
    ?>
</body>
</html>
